{
  "optimisation_summary": {
    "commit": "a9891defc129d8b3d28e3b6a56ce71a3cb1bf6b4",
    "qa_defaults": {
      "Research": 95,
      "Drafting": 90,
      "Data-transform": 92,
      "Transcription": 88,
      "Other": 95
    },
    "schema_ok": true,
    "alert_webhook_ok": false,
    "weekly_rollup_ok": true
  },
  "optimizations_applied": {
    "version_control_binding": {
      "status": "complete",
      "features": [
        "Git commit hash read on startup",
        "Commit included in every Notion log",
        "Health endpoint returns commit/branch",
        "Deployment logging with git info",
        "Dirty tree check (ALLOW_DIRTY override)"
      ]
    },
    "dynamic_qa_thresholds": {
      "status": "complete",
      "thresholds": {
        "Research": 95,
        "Drafting": 90,
        "Data-transform": 92,
        "Transcription": 88,
        "Other": 95
      },
      "features": [
        "Task Type property in Queue DB",
        "QA Target custom override property",
        "Per-task-type threshold enforcement",
        "Failure on score < threshold"
      ]
    },
    "error_budget_dashboard": {
      "status": "complete",
      "metrics": [
        "week_start",
        "jobs_total",
        "failures_total",
        "failure_rate",
        "top_3_failure_causes",
        "mean_qa",
        "p95_latency_ms",
        "cost_sum"
      ],
      "schedule": "Every Monday 09:00 Europe/London"
    },
    "automated_schema_enforcement": {
      "status": "complete",
      "validation": "Pre-flight checks all 3 databases",
      "auto_repair": "Creates missing properties when safe",
      "blocking_errors": "Precise diff on repair failure",
      "changes_applied": [
        "Queue: Task Type (Select)",
        "Queue: QA Target (Number)",
        "Log: Commit (Rich Text)",
        "Job Log: Commit (Rich Text)",
        "Job Log: Task Type (Select)",
        "Job Log: Duration (ms) (Number)",
        "Job Log: Tokens In (Number)",
        "Job Log: Tokens Out (Number)"
      ]
    },
    "alerting_policy": {
      "status": "complete",
      "trigger": "â‰¥3 consecutive failures within 24h",
      "actions": [
        "Automation Log entry (Status: Warning)",
        "Webhook POST to ALERT_WEBHOOK_URL",
        "Deduplication for 1h per key"
      ],
      "tracking": "In-memory + Notion-backed counters"
    }
  },
  "new_files_created": [
    "bot/git_utils.py",
    "bot/schema_validator.py",
    "bot/qa_thresholds.py",
    "bot/alerting.py",
    "bot/metrics.py",
    "run_optimizations.py"
  ],
  "files_updated": [
    "bot/config.py",
    "bot/notion_api.py",
    "bot/processor.py",
    "bot/main.py",
    "replit.md"
  ],
  "structured_logging": {
    "fields": [
      "job_id",
      "queue_page_id",
      "stage",
      "commit",
      "task_type",
      "qa_target",
      "qa_score",
      "tokens_in",
      "tokens_out",
      "cost_usd",
      "duration_ms"
    ],
    "idempotency_key": "sha256(job_id+stage)",
    "retry_policy": "429 with jitter"
  },
  "health_endpoint": {
    "fields": [
      "status",
      "commit",
      "branch",
      "model",
      "rate_limit_headroom",
      "last_alert_ts"
    ]
  },
  "production_ready": true,
  "deployment_status": "Demo mode (awaiting database IDs)",
  "exit_code": 0
}
