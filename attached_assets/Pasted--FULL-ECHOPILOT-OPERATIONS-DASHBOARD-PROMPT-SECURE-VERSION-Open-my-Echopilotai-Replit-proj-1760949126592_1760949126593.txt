---

ğŸ§  FULL ECHOPILOT OPERATIONS DASHBOARD PROMPT (SECURE VERSION)

Open my Echopilotai Replit project and perform all of the following steps **in one go**:

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”§ OBJECTIVE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Create a secure operational dashboard at `/dashboard` to monitor and control EchoPilotâ€™s system without exposing any secrets.
This dashboard will call backend proxy routes that handle tokens server-side and display live system status (health, supervisor, jobs, finance, governance).

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ—‚ï¸ FILES & STRUCTURE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Create `dashboard.html` at the project root.
2. In `run.py` (Flask main), add these new routes:

    âœ… GET `/api/health`
       â†’ Returns system health JSON from internal `/health`.

    âœ… GET `/api/supervisor-status`
       â†’ Internally calls `/supervisor?token=<HEALTH_TOKEN>` via Flask test_client or requests, returns parsed JSON (3-line summary only).

    âœ… POST `/api/pulse`
       â†’ Internally posts to `/pulse?token=<HEALTH_TOKEN>` and returns status: â€œcreatedâ€ or â€œerrorâ€.

    âœ… POST `/api/create-test-job`
       â†’ Adds a new job to the Notion Automation Queue using:
         Payload Link: https://filesamples.com/samples/audio/mp3/sample1.mp3
         Job Name: â€œDashboard Test Jobâ€
         Trigger: true
         Status: â€œNewâ€.

    âœ… GET `/api/job-log-latest`
       â†’ Queries ğŸ™ï¸ EchoPilot Job Log DB (using JOB_LOG_DB_ID), returning the latest jobâ€™s:
         { Job Name, QA, Duration Sec, Gross USD, Profit USD, Margin %, Payment Status }.
         Includes retry/backoff 5sâ†’10sâ†’20sâ†’30s for Notion sync lag.

    âœ… POST `/api/flip-paid`
       â†’ Input: { "page_id": "<Notion Job ID>" }
         Sets Payment Status = â€œPaidâ€ in Job Log and confirms update.

    âœ… GET `/dashboard`
       â†’ Serves the `dashboard.html` file securely.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§± SECURITY RULES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Use `os.getenv("HEALTH_TOKEN")` server-side only (never expose to frontend).
- All `/api/*` routes require a request header `X-Dash-Key` matching env `DASHBOARD_KEY`.
- Return uniform JSON shape: `{ "ok": true|false, "data": <object|null>, "error": <string|null> }`.
- Apply `Cache-Control: no-store`, `X-Frame-Options: DENY` to dashboard responses.
- CSRF protection: for POSTs, require Origin/Referer contains â€œechopilotai.replit.appâ€.
- CORS disabled (same-origin only).

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ’» FRONTEND (dashboard.html)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Clean minimal UI:
  â€¢ Buttons: Check Health, Supervisor Status, Send Pulse, Create Test Job, Refresh Job Log, Flip Paid.
  â€¢ Readout area (`<pre id="log">`) showing formatted JSON results.
- Use a small JS fetch wrapper:

async function callAPI(endpoint, method='GET', body=null) { log(Calling ${endpoint}...); const res = await fetch(endpoint, { method, headers: { 'Content-Type': 'application/json', 'X-Dash-Key': '<read from input field>', }, body: body ? JSON.stringify(body) : null }); const json = await res.json(); log(JSON.stringify(json, null, 2)); }

- Disable buttons while a call runs, show spinner or â€œWorkingâ€¦â€ label.
- Add a small text input at the top for DASHBOARD_KEY.
- No environment variables in frontend.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âš™ï¸ ENVIRONMENT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Confirm these secrets exist in Replit:
- HEALTH_TOKEN
- JOB_LOG_DB_ID
- AUTOMATION_QUEUE_DB_ID
- DASHBOARD_KEY (create one if missing; any long random string)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§ª VALIDATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
After setup:
1. Open: https://Echopilotai.replit.app/dashboard
2. Enter your DASHBOARD_KEY in the input box.
3. Click buttons in this order:
 âœ… Check Health
 âœ… Supervisor Status
 âœ… Send Pulse
 âœ… Create Test Job
 âœ… (wait 60â€“90s)
 âœ… Refresh Job Log
 âœ… Flip Paid
4. Verify all JSON responses show `"ok": true`.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“¦ COMMIT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
After successful testing:
Commit all changes with message:
"Add secure ops dashboard + API proxy routes for EchoPilot"

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… EXPECTED OUTCOME
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Secure, functional dashboard served at `/dashboard`
- All API calls proxy safely through Flask
- No secrets in frontend
- Health, supervisor, governance, and finance checks working
- Ready for daily use and diagnostics

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§© BONUS (OPTIONAL)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
If time allows, add:
- Metrics summary (Jobs_7d, Revenue_7d, Avg_QA_7d) card
- Button to trigger `/api/release-captain` (dry-finance validation mode)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€


---

âœ… Next:
Once Replit AI finishes, open /dashboard â†’ test each button â†’ copy any JSON or error output here so I can verify functionality.

