You are the Replit AI Agent. Implement Levqor Connector Wave v1. Do not ask questions. Fail closed on any error and print the failing step + file path.

GOAL
Ship five production-ready connector endpoints with strict schemas, masking, quotas, and tests:
1) Slack (webhook)
2) Notion (pages)
3) Google Sheets (append)
4) Telegram (bot)
5) Email (Resend) — already exists; standardize to same contract

ENV (read from secrets; never echo)
SLACK_WEBHOOK_URL
NOTION_API_KEY
TELEGRAM_BOT_TOKEN
TELEGRAM_CHAT_ID_DEFAULT   # optional default
GOOGLE_SERVICE_ACCOUNT_JSON  # base64 or raw JSON
GOOGLE_SHEETS_SPREADSHEET_ID
RESEND_API_KEY              # already live
BILLING_ENABLED=true

FILES/CHANGES

A) CORE: request schema + quota + logging
1. Create `connectors/contracts.py` with pydantic models:
   - SlackSend(text:str, channel:Optional[str])
   - NotionCreate(database_id:str, props:dict)
   - SheetsAppend(range:str, values:list[list[str]])
   - TelegramSend(text:str, chat_id:Optional[str])
   - EmailSend(to:str, subject:str, text:str)
2. Create `connectors/limits.py`:
   - free: 1 successful run/day
   - pro: unlimited
   - helper: `check_quota(user_or_ip:str, connector:str) -> None | raises 402`
   - persist counts in `data/usage_quota.json` with UTC day key.
3. Create `connectors/masking.py`:
   - `mask(s:str) -> str` keep first 4, last 2, else `****`.
4. Append structured logging to `logs/connectors.log`:
   - JSON lines: {ts, ip, user:anon, connector, status, ms, ids_masked:true}
   - never log payload content or secrets.

B) ENDPOINTS (Flask/FastAPI app: add under `/actions/*`)
1. **Slack**
   `POST /actions/slack.send`
   - Body: SlackSend
   - Requires `SLACK_WEBHOOK_URL`
   - POST json {"text": text} to webhook; channel optional via block or prefix
   - Return `{status:"sent"}`
   - If env missing → 503 with `"reason":"not_configured"`

2. **Notion**
   `POST /actions/notion.create`
   - Body: NotionCreate
   - Requires `NOTION_API_KEY`
   - POST https://api.notion.com/v1/pages with bearer, `parent.database_id`, `properties` = props
   - Return `{status:"created", id:"page_***"}`
   - Missing env → 503

3. **Google Sheets**
   `POST /actions/sheets.append`
   - Body: SheetsAppend
   - Requires `GOOGLE_SERVICE_ACCOUNT_JSON` + `GOOGLE_SHEETS_SPREADSHEET_ID`
   - Use service account to call Sheets API `values.append` with `valueInputOption=RAW`
   - Return `{status:"appended", updated:n}`
   - Missing env → 503

4. **Telegram**
   `POST /actions/telegram.send`
   - Body: TelegramSend
   - Requires `TELEGRAM_BOT_TOKEN`
   - chat_id: body.chat_id or `TELEGRAM_CHAT_ID_DEFAULT`
   - POST https://api.telegram.org/bot<TOKEN>/sendMessage
   - Return `{status:"sent"}`
   - Missing env → 503

5. **Email (Resend)**
   `POST /actions/email.send`
   - Body: EmailSend
   - Use existing Resend integration; standardize response to `{status:"sent"}`
   - If `RESEND_API_KEY` missing → 503

C) SECURITY + QUOTAS
- Pre-handler:
  - Identify caller by `Authorization: Bearer <token>` if present else `X-Forwarded-For` IP.
  - Call `check_quota(id, connector)`. On free plan exceed → return 402 JSON `{error:"rate_limited", upgrade:"/pricing"}`
- CORS: ensure ALLOWED_ORIGINS already configured; reuse.
- Timeouts: outbound HTTP 10s; retry 1 time on 5xx with backoff.
- Mask all returned external IDs with `mask()` in logs only.

D) HEALTH + DOCS
1. `GET /actions/health`:
   - Returns which connectors are `configured:true/false`
2. `docs/CONNECTORS.md`:
   - Auth model, env list, request/response examples for all five.
3. Update `/billing/health` to include `"connectors":{"slack":bool,...}`

E) TESTS (must pass; fail closed)
1. Create `tests/test_connectors_smoke.py`:
   - Skip each connector if its env is not set, else assert 200 and `{status:"sent"|"created"|"appended"}`
   - Always test email.send path if RESEND_API_KEY exists.
2. CLI quick smoke:
   - `bash scripts/smoke_connectors.sh`:
     ```
     set -e
     curl -fsS -X POST $BASE/actions/email.send -H 'Content-Type: application/json' -d '{"to":"support@levqor.ai","subject":"smoke","text":"ok"}' | jq -e '.status=="sent"'
     curl -s $BASE/actions/health | jq .
     ```
   - Save outputs to `evidence/connectors_smoke_$(date -u +%Y%m%d).json`

F) OBSERVABILITY
- Add counters to `/api/usage/summary`: total_runs, by_connector map last 7/30 days.
- Expose `metrics` style line: `connector_runs_total{connector="slack"} N` in `/ops/uptime`.

G) CI/CD
- Add GitHub Action `connectors-ci.yml`:
  - Lint, unit tests, build.
  - On push to `sprint-connectors` branch, deploy to preview.
  - On PR to main, run smoke against preview URL; require green.

H) OUTPUT (print only non-sensitive)
- connectors_configured: map of bools
- endpoints: list of routes added
- tests: pass/fail summary
- smoke_evidence: last evidence file path
- next_steps: which envs missing

SAFETY
- Never print secrets or payload content.
- 503 on not configured. 402 on free-plan limit. 5xx only on upstream fatal.
- Log minimal JSON lines only. No PII.