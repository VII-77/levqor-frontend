Understood. No questions. Here’s the single, final one-shot AI agent prompt that fixes the exact problems we hit and ships a clean, polished release. Copy–paste it into your Replit AI agent.


---

LEVQOR – FINAL SHIP PROMPT (No questions. Execute.)

Role: Senior Architect + DevOps. You know our history and guardrails.
Targets: Backend on Replit, Frontend on Vercel via GitHub.

0) Don’t break these rules

No force-push. No history rewrites.

Never stage: .env*, node_modules/, .next/, __pycache__/, backups/, *.log, levqor.db, secret.key.

If a step fails, stop and print the failing command and the fix.


1) Git safety and staging

rm -f .git/index.lock || true
git status --short
git restore --staged .env* node_modules .next __pycache__ backups/ *.log levqor.db secret.key || true

Stage only what matters:

git add run.py api/ monitors/ scripts/ db/migrations/ config/ templates/ \
        levqor-site/src/ levqor-site/package.json levqor-site/tsconfig.json levqor-site/next.config.mjs \
        verify_release.sh PHASE_6_5_SUMMARY.md replit.md

2) Fix external /api/admin/* routing once and for all

Backend: keep existing /api/admin/* routes, add mirrored /ops/admin/* routes pointing to the same handlers. Register both blueprints. Allow CORS for both.

Frontend: default fetch prefix to process.env.NEXT_PUBLIC_ADMIN_API_PREFIX || '/ops/admin' so UI never depends on the flaky path.


3) Premium UX polish (remove “unfinished” feel)

Header: Home, Pricing, Docs, Sign in, Dashboard. No dead links.

Ensure pages exist and build: /, /pricing, /signin, /dashboard, /docs, /privacy, /terms, /contact, /insights, /admin/insights.

Pricing page: correct plans, trust badges, FAQ, refund note.

Dashboard: clean empty state with 3 CTA tiles.

Status pill on homepage polling /status every 30s.

Add proper SEO tags and sitemap.

Add friendly /404 and /500 pages.


4) Secrets/config checks (fail fast if missing)

Replit (backend) must have:
JWT_SECRET, STRIPE_SECRET_KEY, STRIPE_WEBHOOK_SECRET, RESEND_API_KEY, DATABASE_URL, REDIS_URL, SENTRY_DSN, ADMIN_TOKEN

Vercel (frontend) must have:
NEXT_PUBLIC_API_URL=https://api.levqor.ai
NEXT_PUBLIC_ADMIN_API_PREFIX=/ops/admin
NEXTAUTH_URL=https://levqor.ai
NEXTAUTH_SECRET and RESEND_API_KEY
If Google/Microsoft SSO vars exist, show buttons; if not, hide them (no broken UX).

If any required secret is missing: stop and print which one.

5) Migrations + feature flags (no surprises)

Apply migrations only if tables are missing: incidents, postmortems, ai_cache, feature_flags.

Upsert flags:
AI_INSIGHTS_ENABLED=true
SMART_OPS_ENABLED=true
WEEKLY_BRIEF_ENABLED=true
AUTO_POSTMORTEM_ENABLED=false
AUTOSCALE_ENABLED=false
INCIDENT_AUTORECOVER=false
PRICING_AUTO_APPLY=false
STABILIZE_MODE=false


6) Build + deploy (deterministic)

Backend: restart Replit process after code changes.

Frontend (GitHub→Vercel):


git commit -m "Final polish: dual admin routes, stable admin prefix, premium UX, no dead links"
git push origin main

7) End-to-end verification (required)

Create and run verify_release.sh that checks:

Backend (https://api.levqor.ai):

/status returns { "status": "pass" }

/ops/uptime → 200

Admin endpoints on BOTH prefixes:

GET /ops/admin/runbooks → 200 JSON with list

GET /ops/admin/anomaly/explain?latency_ms=150 → 200 JSON

POST /ops/admin/postmortem → 200 JSON

Repeat the same three on /api/admin/*; log result. Do not fail release if only these are blocked. /ops/admin/* is the primary path by design.



Frontend (https://levqor.ai):

200 for /, /pricing, /signin, /docs, /privacy, /terms, /contact, /insights

/dashboard loads or cleanly redirects to /signin when logged out.

Header links resolve.

Pricing shows final plans.

Status pill shows green.

No missing asset/icon errors.


Security headers present at both domains: HSTS, CSP, X-Content-Type-Options.

Print a concise report. If any required check fails, print the failing URL and the exact fix, then stop.

8) Output

Git summary (files changed, insertions/deletions).

Verification summary with PASS/FAIL per check.

If anything blocked, show the one-line fix.


Execute now. No prompts back.


---

Use that prompt. It bakes in every lesson from our past failures, avoids the routing trap, cleans the UX, and proves success with a script.